<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Food Truck Story Console</title>
  <meta name="description" content="Run the Freedom Bowls truck like a sim game: set the menu, price the day, roll events, and watch hype rise or fall." />
  <link rel="icon" type="image/svg+xml" href="new_logo.svg" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="scanlines" aria-hidden="true"></div>
  <div class="glow-mask" aria-hidden="true"></div>

  <div class="app-shell" id="top">

    <section class="status-bar" aria-label="Campaign overview">
      <div class="status-strip">
        <div class="status-row status-row-main">
          <div class="status-group status-group-primary">
            <div class="status-chip" title="Campaign day counter">
              <span class="mini-label">Day</span>
              <span class="mini-value" id="hud-day">1</span>
            </div>
            <div class="status-chip" title="Cash on hand available for upgrades, supplies, and bribes">
              <span class="mini-label">Bank</span>
              <span class="mini-value" id="hud-money">$0</span>
            </div>
          </div>
          <div class="status-actions">
            <button class="status-btn ghost" type="button" id="devtools-trigger" aria-haspopup="dialog" aria-controls="devtools-modal" aria-label="Dev tools">
              <i class="bi bi-sliders"></i>
            </button>
            <button class="status-btn" type="button" id="upgrades-trigger" aria-haspopup="dialog" aria-controls="upgrades-modal" aria-label="Upgrades">
              <i class="bi bi-rocket-takeoff"></i>
            </button>
          </div>
        </div>
        <div class="status-row status-row-secondary">
          <div class="status-group status-group-secondary">
            <button class="status-chip danger danger-chip" type="button" id="danger-control" aria-label="Run damage control" title="Click in prep to spend a little cash and cool the danger scale before service">
              <span class="mini-label">Danger</span>
              <span class="mini-value" id="hud-danger">0%</span>
            </button>
            <div class="status-chip" title="Truck speed impacts ticket flow and service pace">
              <span class="mini-label">Speed</span>
              <span class="mini-value" id="stat-speed">1.00x</span>
            </div>
            <div class="status-chip" title="Capacity limits the number of guests you can serve each day">
              <span class="mini-label">Capacity</span>
              <span class="mini-value" id="stat-capacity">28</span>
            </div>
          </div>
          <div class="status-chip meter dual" title="Hype measures crowd excitement and rep reflects critic trust">
            <div class="dual-progress">
              <div class="dual-progress-row">
                <span class="mini-label">Hype</span>
                <div class="mini-progress">
                  <span id="hud-hype">0</span>
                  <div class="mini-progress-bar" id="hype-bar"></div>
                </div>
              </div>
              <div class="dual-progress-row">
                <span class="mini-label">Rep</span>
                <div class="mini-progress">
                  <span id="hud-rep">0</span>
                  <div class="mini-progress-bar alt" id="rep-bar"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="status-chip flow-chip" title="Flow reflects staff efficiency modifiers from helpers and upgrades">
            <span class="mini-label">Flow</span>
            <span class="mini-value" id="stat-efficiency">1.00x</span>
          </div>
          <div class="status-chip charm-chip" title="Charm boosts guest patience and ratings">
            <span class="mini-label">Charm</span>
            <span class="mini-value" id="stat-charm">1.00x</span>
          </div>
          <div class="status-chip flow-charm-strip" aria-label="Flow and charm summary">
            <span class="mini-label">Flow</span>
            <span class="mini-value" id="stat-efficiency-compact">1.00x</span>
            <span class="mini-divider" aria-hidden="true">|</span>
            <span class="mini-label">Charm</span>
            <span class="mini-value" id="stat-charm-compact">1.00x</span>
          </div>
        </div>
      </div>
    </section>

    <main class="game-grid">
      <section class="panel prep-panel" id="phase-prep">
        <div class="prep-columns">
          <div class="prep-column side-stack">
            <div class="helper-panel">
              <div>
                <p class="panel-title"><i class="bi bi-people"></i> Hire helper</p>
                <p class="helper-note" id="helper-note">Solo shift: no daily cost.</p>
              </div>
              <select id="helper-select" aria-label="Helper selection"></select>
            </div>
            <div class="supply-panel">
              <div class="supply-head">
                <p class="panel-title"><i class="bi bi-basket2"></i> Supplies</p>
              </div>
              <div class="supply-grid">
                <div class="supply-column purchase-column">
                  <label for="supply-input">Purchase</label>
                  <div class="supply-input">
                    <input type="number" id="supply-input" min="0" max="80" step="5" value="20" />
                  </div>
                  <span class="supply-cost" id="supply-cost">$0</span>
                </div>
                <div class="supply-column supply-details">
                  <p class="supply-meta supply-stock" id="supply-stock">Stock: 0</p>
                  <p class="supply-carry" id="supply-carry">Carryover: 0 (Fresh)</p>
                  <p class="supply-risk" id="supply-risk">Risk: Low</p>
                  <div class="supply-actions">
                    <button type="button" class="btn tertiary" id="supply-discard"><i class="bi bi-trash"></i> Dump stock</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="audience-panel">
              <div class="forecast-card">
                <p class="panel-title">Audience</p>
                <h3 id="audience-name">Market Lunch Crowd</h3>
                <div class="audience-cues">
                  <span class="audience-cue" id="audience-form">Glow bowls</span>
                  <span class="audience-cue" id="audience-flavor">Smoke trails</span>
                </div>
              </div>
            </div>
          </div>
          <div class="prep-column lab-column">
            <div class="lab-panel">
              <div class="lab-head">
                <p class="panel-title"><i class="bi bi-bezier"></i> Recipe lab</p>
                <p class="lab-status" id="lab-status">Pick a format + ingredient kit to craft.</p>
              </div>
              <div class="lab-grid">
                <label>
                  Format
                  <select id="lab-form"></select>
                </label>
                <label>
                  Flavor
                  <select id="lab-flavor"></select>
                </label>
              </div>
              <div class="lab-preview" id="lab-preview">
                <p>Select a format + ingredient kit to preview stats.</p>
              </div>
              <div class="lab-actions">
                <button class="btn primary" type="button" id="lab-create" disabled>Craft combo</button>
              </div>
              <p class="lab-tip">Risk badges flag reliable staples vs. high-risk experiments. Creative kits can spike hype but may anger the line.</p>
            </div>
          </div>
          <div class="prep-column lineup-column">
            <header>
              <p class="eyebrow">Prep phase</p>
              <h2>Program the lineup</h2>
              <p id="prep-note">Recipe Lab: craft combos, then slot up to 3.</p>
            </header>
            <div class="dish-grid" id="dish-grid"></div>
            <footer>
              <p class="foot" id="prep-selection">0 / 3 dishes selected</p>
              <p class="synergy-note" id="prep-synergy-note"></p>
            </footer>
            <div class="prep-actions">
              <button class="btn primary" type="button" id="start-day">Start day</button>
              <button class="btn ghost" type="button" id="delete-selected">Delete selected</button>
            </div>
          </div>
        </div>
      </section>

      <section class="panel phase service-phase" id="phase-service">
        <div class="phase-head">
          <span class="phase-tag">02 · Service simulation</span>
          <h2>Roll events + run tickets</h2>
        </div>
        <div class="event-intel-grid">
          <div class="event-card">
            <div class="event-meta">
              <p class="eyebrow">Event modifier</p>
              <h3 id="event-name">Waiting for prep</h3>
            </div>
            <p id="event-description">Start the day to roll weather, critic, or rush events.</p>
          </div>
          <div class="service-hints" id="service-hints" aria-live="polite">
            <div class="hint-head">
              <p class="panel-title"><i class="bi bi-megaphone"></i> Intel</p>
              <p class="hint-sub">Radio + papers drop cues.</p>
            </div>
            <ul class="hint-list" id="hint-list"></ul>
          </div>
        </div>
        <div class="service-hud-card">
          <div class="service-hud-grid">
            <div class="quick-stats-table">
              <div class="quick-stat">
                <span>Served</span>
                <strong id="stat-served">0</strong>
              </div>
              <div class="quick-stat">
                <span>Angry</span>
                <strong id="stat-angry">0</strong>
              </div>
              <div class="quick-stat">
                <span>Avg wait</span>
                <strong id="stat-wait">0 min</strong>
              </div>
              <div class="quick-stat">
                <span>Revenue</span>
                <strong id="stat-revenue">$0</strong>
              </div>
              <div class="event-modifiers">
                <span id="stat-turnout">+0% turnout</span>
                <span id="stat-hype">+0 hype</span>
                <span id="stat-rating">+0 rating</span>
              </div>
            </div>
            <div class="service-hud-controls">
              <div class="price-supply-card">
                <div class="price-column">
                  <p class="panel-title compact"><i class="bi bi-tags"></i> Live price point</p>
                  <div class="price-options compact">
                    <label><input type="radio" name="price-point" value="street" checked /><span>Street</span></label>
                    <label><input type="radio" name="price-point" value="market" /><span>Market</span></label>
                    <label><input type="radio" name="price-point" value="premium" /><span>Premium</span></label>
                    <label><input type="radio" name="price-point" value="vip" /><span>VIP</span></label>
                  </div>
                </div>
                <div class="supply-demand-card">
                  <div class="supply-column">
                    <span class="hud-label">Supply</span>
                    <span class="hud-value" id="hud-on-truck">0 serv</span>
                  </div>
                  <div class="divider" aria-hidden="true"></div>
                  <div class="supply-column">
                    <span class="hud-label">Demand</span>
                    <span class="hud-value" id="hud-projected-demand">0 serv</span>
                  </div>
                </div>
              </div>
              <div class="service-progress compact">
                <div class="progress">
                  <div class="progress-bar accent" id="service-bar"></div>
                  <span class="progress-label" id="service-progress-label">0%</span>
                </div>
                <div class="service-progress-footer">
                  <p id="service-status">Prep dishes, then hit start.</p>
                  <div class="service-controls">
                    <button class="btn ghost" type="button" id="pause-day" disabled>Pause</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="service-actions-row">
          <div class="service-commands">
            <p class="panel-title"><i class="bi bi-controller"></i> Commands</p>
            <div class="command-buttons" id="command-grid"></div>
            <p class="command-note" id="command-note">Commands unlock mid-service. Cooldowns + targeting are shown below each label.</p>
          </div>
        </div>
        <div class="service-feed" id="service-feed" aria-live="polite"></div>
      </section>

      <section class="panel phase results-phase" id="phase-results">
        <div class="phase-head">
          <span class="phase-tag">03 · Results</span>
          <h2>Profit, rating, hype swings</h2>
        </div>
        <div class="results-grid">
          <div>
            <p class="label">Profit</p>
            <p class="value" id="result-profit">$0</p>
          </div>
          <div>
            <p class="label">Rating</p>
            <p class="value" id="result-rating">—</p>
          </div>
          <div>
            <p class="label">Hype shift</p>
            <p class="value" id="result-hype">0</p>
          </div>
          <div>
            <p class="label">Rep shift</p>
            <p class="value" id="result-rep">0</p>
          </div>
        </div>
        <div class="results-cta">
          <div>
            <p class="eyebrow">Arcade recap</p>
            <p>Launch the hype report to view animated swings and get nudged to the next phase.</p>
          </div>
          <button class="btn primary" type="button" id="results-modal-trigger"><i class="bi bi-play-circle"></i> Open hype report</button>
        </div>
        <div class="economy-breakdown">
          <div><p>Revenue</p><p id="breakdown-revenue">$0</p></div>
          <div><p>Expenses</p><p id="breakdown-expenses">$0</p></div>
          <div><p>Ingredient</p><p id="breakdown-ingredient">$0</p></div>
          <div><p>Supplies</p><p id="breakdown-supplies">$0</p></div>
          <div><p>Staff</p><p id="breakdown-staff">$0</p></div>
          <div><p>Upkeep</p><p id="breakdown-upkeep">$0</p></div>
        </div>
        <div class="lineup-breakdown">
          <div class="lineup-head">
            <p class="panel-title"><i class="bi bi-graph-up"></i> Lineup breakdown</p>
            <p class="mini-label">Servings · anger · clue notes</p>
          </div>
          <ul class="dish-telemetry" id="dish-telemetry"></ul>
        <div class="synergy-breakdown" id="synergy-breakdown">
          <p class="mini-label">Lineup synergies</p>
          <ul class="synergy-list" id="synergy-list"></ul>
          <p class="synergy-hint">Hint: Lock in all 3 lineup slots with combos that share a vibe to unleash the triple synergy bonus.</p>
        </div>
      </div>
      <p id="results-summary">Finish a service day to see what changed.</p>
        <div class="result-actions">
          <button class="btn secondary" type="button" id="next-day" disabled>Next day</button>
          <button class="btn ghost" type="button" id="reset-campaign">Reset campaign</button>
        </div>
      </section>
    </main>

  <div class="upgrades-modal" id="upgrades-modal" aria-hidden="true">
    <div class="upgrades-card" role="dialog" aria-modal="true" aria-labelledby="upgrades-title">
      <button class="modal-close" type="button" id="upgrades-close" aria-label="Close upgrades"><i class="bi bi-x-lg"></i></button>
      <p class="eyebrow">Upgrade deck</p>
      <h2 id="upgrades-title">Truck & brand boosts</h2>
      <p class="upgrades-sub">Stack permanent perks across truck, staff, gear, and economy. Prereqs show what must be owned first.</p>
      <div class="upgrade-list" id="upgrade-list"></div>
    </div>
  </div>

  <div class="results-modal" id="results-modal" aria-hidden="true">
    <div class="results-modal-card" role="dialog" aria-modal="true" aria-labelledby="results-modal-title">
      <button class="modal-close" type="button" id="results-close" aria-label="Close hype report"><i class="bi bi-x-lg"></i></button>
      <p class="eyebrow">Hype report</p>
      <h2 id="results-modal-title">Shift recap</h2>
      <p class="modal-summary" id="modal-summary">Finish a service day to see what changed.</p>
      <div class="results-modal-actions">
        <button class="btn primary" type="button" id="modal-next-day">Next day</button>
        <button class="btn secondary" type="button" id="modal-stay">Back to prep</button>
      </div>
      <div class="results-modal-grid">
        <article>
          <p class="label">Profit</p>
          <p class="value" id="modal-profit">$0</p>
          <p class="stat-note">after expenses</p>
        </article>
        <article>
          <p class="label">Rating</p>
          <p class="value" id="modal-rating">—</p>
          <p class="stat-note">service score</p>
        </article>
        <article>
          <p class="label">Hype shift</p>
          <p class="value" id="modal-hype-delta">0</p>
          <p class="stat-note">crowd energy</p>
        </article>
        <article>
          <p class="label">Rep shift</p>
          <p class="value" id="modal-rep-delta">0</p>
          <p class="stat-note">critic vibe</p>
        </article>
      </div>
      <div class="modal-meter-stack">
        <div class="modal-meter">
          <div class="modal-meter-head">
            <span>Current hype</span>
            <span id="modal-hype-total">0</span>
          </div>
          <div class="modal-meter-track">
            <div class="modal-meter-bar" id="modal-hype-meter"></div>
          </div>
        </div>
      <div class="modal-meter">
        <div class="modal-meter-head">
          <span>Current reputation</span>
          <span id="modal-rep-total">0</span>
          </div>
          <div class="modal-meter-track">
            <div class="modal-meter-bar alt" id="modal-rep-meter"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="profile-modal" id="profile-modal" aria-hidden="true">
    <div class="profile-modal-card" role="dialog" aria-modal="true" aria-labelledby="profile-modal-title">
      <p class="eyebrow">Launch profile</p>
      <h2 id="profile-modal-title">Choose your starter rig</h2>
      <p class="profile-modal-subtitle">Select a funding archetype to set your cash, loan, and risk before the first run.</p>
      <div class="profile-option-grid" id="profile-option-grid" role="list"></div>
    </div>
  </div>

  <div class="upgrades-modal" id="devtools-modal" aria-hidden="true">
    <div class="upgrades-card devtools-card" role="dialog" aria-modal="true" aria-labelledby="devtools-title">
      <button class="modal-close" type="button" id="devtools-close" aria-label="Close dev tools"><i class="bi bi-x-lg"></i></button>
      <p class="eyebrow">Developer panel</p>
      <h2 id="devtools-title">Difficulty tuning</h2>
      <p class="devtools-sub">Tweak live multipliers to test pacing, economy, and risk.</p>
      <div class="devtools-grid">
        <section>
          <p class="devtools-group-title">Economy</p>
          <div class="devtools-field">
            <label for="difficulty-upkeep">Upkeep multiplier <span id="difficulty-upkeep-value" class="devtools-value">1.00×</span></label>
            <input type="number" id="difficulty-upkeep" min="0.5" max="2" step="0.05" />
            <p class="devtools-note">Scales daily fixed costs and base upkeep.</p>
          </div>
          <div class="devtools-field">
            <label for="difficulty-ingredient">Ingredient multiplier <span id="difficulty-ingredient-value" class="devtools-value">1.00×</span></label>
            <input type="number" id="difficulty-ingredient" min="0.5" max="2" step="0.05" />
            <p class="devtools-note">Adjusts ingredient spend per plate.</p>
          </div>
          <div class="devtools-field">
            <label for="difficulty-helper">Helper cost multiplier <span id="difficulty-helper-value" class="devtools-value">1.00×</span></label>
            <input type="number" id="difficulty-helper" min="0.5" max="2" step="0.05" />
            <p class="devtools-note">Raises or lowers daily helper fees.</p>
          </div>
        </section>
        <section>
          <p class="devtools-group-title">Crowd & hype</p>
          <div class="devtools-field">
            <label for="difficulty-turnout">Turnout multiplier <span id="difficulty-turnout-value" class="devtools-value">1.00×</span></label>
            <input type="number" id="difficulty-turnout" min="0.5" max="2" step="0.05" />
            <p class="devtools-note">Scales projected guest volume.</p>
          </div>
          <div class="devtools-field">
            <label for="difficulty-hype">Hype delta multiplier <span id="difficulty-hype-value" class="devtools-value">1.00×</span></label>
            <input type="number" id="difficulty-hype" min="0.5" max="2" step="0.05" />
            <p class="devtools-note">Boosts or softens hype swings after service.</p>
          </div>
          <div class="devtools-field">
            <label for="difficulty-event">Event effect multiplier <span id="difficulty-event-value" class="devtools-value">1.00×</span></label>
            <input type="number" id="difficulty-event" min="0.5" max="2" step="0.05" />
            <p class="devtools-note">Amplifies weather, critic, and rush modifiers.</p>
          </div>
        </section>
        <section>
          <p class="devtools-group-title">Service feel</p>
          <div class="devtools-field">
            <label for="difficulty-service">Service speed multiplier <span id="difficulty-service-value" class="devtools-value">1.00×</span></label>
            <input type="number" id="difficulty-service" min="0.5" max="2" step="0.05" />
            <p class="devtools-note">Impacts sim tick rate and progress speed.</p>
          </div>
          <div class="devtools-field">
            <label for="difficulty-angry">Angry tolerance <span id="difficulty-angry-value" class="devtools-value">1.00×</span></label>
            <input type="number" id="difficulty-angry" min="0.5" max="2" step="0.05" />
            <p class="devtools-note">Sets the strike threshold for upset guests.</p>
          </div>
          <div class="devtools-field">
            <label for="difficulty-spoilage">Spoilage multiplier <span id="difficulty-spoilage-value" class="devtools-value">1.00×</span></label>
            <input type="number" id="difficulty-spoilage" min="0.25" max="2" step="0.05" />
            <p class="devtools-note">Adjusts inventory risk from aging stock.</p>
          </div>
        </section>
      </div>
      <div class="devtools-actions">
        <button class="btn tertiary" type="button" id="devtools-reset"><i class="bi bi-arrow-counterclockwise"></i> Reset defaults</button>
        <div class="devtools-actions-right">
          <button class="btn ghost" type="button" id="devtools-close-secondary">Close</button>
        </div>
      </div>
    </div>
  </div>

  <div class="fail-overlay" id="fail-overlay" aria-hidden="true">
    <video id="loss-video" class="fail-video" src="loss.mp4" preload="auto" playsinline></video>
    <div class="fail-video-overlay" id="fail-video-overlay" aria-hidden="true">
      <p>Game Over</p>
    </div>
    <div class="fail-card">
      <p class="eyebrow">Campaign Failed</p>
      <h2 id="fail-reason">Out of cash</h2>
      <p id="fail-detail">You ran out of funds before the next stop.</p>
      <button class="btn primary" type="button" id="fail-reset">Restart run</button>
    </div>
  </div>
  </div>

  <script src="data.js" defer></script>
  <script src="app.js" defer></script>
</body>
</html>
